{
  "hash": "38b7382ceb1092d47f33a3d63e3480e7",
  "result": {
    "markdown": "---\ntitle: \"US Solar/Wind\"\ndraft: true\n---\n\n\n\n## Purpose\n\nNot sure yet - just needed the comfort of Rstudio\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n-- Attaching packages --------------------------------------- tidyverse 1.3.1 --\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nv ggplot2 3.3.5     v purrr   0.3.4\nv tibble  3.1.6     v dplyr   1.0.7\nv tidyr   1.1.4     v stringr 1.4.0\nv readr   2.1.1     v forcats 0.5.1\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'tibble' was built under R version 4.1.2\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'readr' was built under R version 4.1.2\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n-- Conflicts ------------------------------------------ tidyverse_conflicts() --\nx dplyr::filter() masks stats::filter()\nx dplyr::lag()    masks stats::lag()\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- read.csv(here::here(\"data\", \"solar_panels_sweden.csv\")) %>% as_tibble() %>% janitor::clean_names()\n\ndf <- df %>% \n  mutate(across(.cols = c(4, 5), .fns = parse_number)) %>% \n  separate(region, into = c(\"region_code\", \"region\"), sep = \" \")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: 271 parsing failures.\nrow col expected actual\n 61  -- a number     ..\n 62  -- a number     ..\n 81  -- a number     ..\n 82  -- a number     ..\n141  -- a number     ..\n... ... ........ ......\nSee problems(...) for more details.\n\nWarning: 271 parsing failures.\nrow col expected actual\n 61  -- a number     ..\n 62  -- a number     ..\n 81  -- a number     ..\n 82  -- a number     ..\n141  -- a number     ..\n... ... ........ ......\nSee problems(...) for more details.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expected 2 pieces. Additional pieces discarded in 576 rows [5, 6, 7, 8,\n9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, ...].\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- df %>% \n  mutate(type = case_when(\n    str_count(region_code) == 4 ~ \"kommun\",\n    region == \"Riket\" ~ \"total\",\n    TRUE ~ \"lan\"\n  )) \n\ndf %>% \n  filter(type == \"lan\",\n         effektklass != \"Totalt\") %>% \n  ggplot(aes(solcellsanlaggningar, region, fill = effektklass)) +\n  geom_col()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 4 rows containing missing values (position_stack).\n```\n:::\n\n::: {.cell-output-display}\n![](US_solar_wind_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_kommun <- df %>% \n  filter(type == \"kommun\")\n\ndf_kommun <- df_kommun %>% \n  filter(effektklass == \"Totalt\",\n         ar == 2021)\n\ndf_kommun %>% view\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmap <- read_rds(here::here(\"data\", \"kommun_map.rds\")) %>% \n  rename(region_code = kn_kod)\n\nlibrary(sf)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'sf' was built under R version 4.1.2\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLinking to GEOS 3.9.1, GDAL 3.2.1, PROJ 7.2.1; sf_use_s2() is TRUE\n```\n:::\n\n```{.r .cell-code}\nmap <- map %>%\n  inner_join(df_kommun)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nJoining, by = \"region_code\"\n```\n:::\n\n```{.r .cell-code}\nmap %>% \n  ggplot() +\n  geom_sf(aes(fill = solcellsanlaggningar)) +\n  scale_fill_viridis_c()\n```\n\n::: {.cell-output-display}\n![](US_solar_wind_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "US_solar_wind_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": null
  }
}