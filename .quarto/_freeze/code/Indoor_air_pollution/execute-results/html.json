{
  "hash": "0d0ffe3ffa7fe5fa279122e9f323b0bf",
  "result": {
    "markdown": "---\ntitle: \"indoor air pollution\"\nformat:\n  html:\n    code-link: true\ndraft: true\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n-- Attaching packages --------------------------------------- tidyverse 1.3.1 --\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nv ggplot2 3.3.5     v purrr   0.3.4\nv tibble  3.1.6     v dplyr   1.0.7\nv tidyr   1.1.4     v stringr 1.4.0\nv readr   2.1.1     v forcats 0.5.1\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'tibble' was built under R version 4.1.2\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'readr' was built under R version 4.1.2\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n-- Conflicts ------------------------------------------ tidyverse_conflicts() --\nx dplyr::filter() masks stats::filter()\nx dplyr::lag()    masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\nlibrary(tidytuesdayR)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'tidytuesdayR' was built under R version 4.1.3\n```\n:::\n\n```{.r .cell-code}\ntheme_set(theme_light())\n\n# tuesdata <- tidytuesdayR::tt_load('2022-04-12')\n# \n# df <- tuesdata$death_source\n\ndf <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-04-12/indoor_pollution.csv')\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 8010 Columns: 4\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n-- Column specification --------------------------------------------------------\nDelimiter: \",\"\nchr (2): Entity, Code\ndbl (2): Year, Deaths - Cause: All causes - Risk: Household air pollution fr...\n\ni Use `spec()` to retrieve the full column specification for this data.\ni Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\ndf <- df %>% \n  janitor::clean_names()\n\ndf <- df %>% \n  rename(death_rate = deaths_cause_all_causes_risk_household_air_pollution_from_solid_fuels_sex_both_age_age_standardized_percent)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf %>% \n  filter(entity == \"Sweden\") %>% \n  ggplot(aes(year, death_rate)) +\n  geom_line()\n```\n\n::: {.cell-output-display}\n![](Indoor_air_pollution_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\ncountries <- df %>% distinct(entity) %>% slice_sample(n = 6)\n\ndf %>% \n  filter(entity %in% countries$entity) %>% \n  ggplot(aes(year, death_rate, colour = entity)) +\n  geom_line() +\n  geom_point() +\n  gghighlight::gghighlight()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nlabel_key: entity\n```\n:::\n\n::: {.cell-output-display}\n![](Indoor_air_pollution_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n:::\n\n\n### Which countries have seen the greatest decline?\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf %>% \n  group_by(entity) %>% \n  filter(year %in% c(2019, 1990)) %>% \n  ungroup() %>% \n  pivot_wider(names_from = year, values_from = death_rate) %>% \n  mutate(delta = `2019` - `1990`,\n         pct_change = delta / `1990`) %>% \n  arrange(pct_change) %>% \n  head(20) %>% \n  knitr::kable()\n```\n\n::: {.cell-output-display}\n|entity               |code |      1990|      2019|      delta| pct_change|\n|:--------------------|:----|---------:|---------:|----------:|----------:|\n|Saudi Arabia         |SAU  | 7.0558976| 0.0303872| -7.0255104| -0.9956934|\n|Egypt                |EGY  | 2.0696774| 0.0124433| -2.0572341| -0.9939878|\n|United Arab Emirates |ARE  | 0.0803153| 0.0005242| -0.0797911| -0.9934733|\n|Oman                 |OMN  | 8.1673093| 0.0553908| -8.1119185| -0.9932180|\n|Libya                |LBY  | 3.6194894| 0.0249859| -3.5945036| -0.9930969|\n|Iraq                 |IRQ  | 4.5903430| 0.0371882| -4.5531548| -0.9918986|\n|Syria                |SYR  | 1.8977519| 0.0191769| -1.8785750| -0.9898949|\n|Tunisia              |TUN  | 2.5720265| 0.0302474| -2.5417791| -0.9882399|\n|Iran                 |IRN  | 1.8996349| 0.0243118| -1.8753230| -0.9872018|\n|Jordan               |JOR  | 0.3528376| 0.0047295| -0.3481082| -0.9865960|\n|Algeria              |DZA  | 2.3047240| 0.0318132| -2.2729108| -0.9861965|\n|Lebanon              |LBN  | 1.9093006| 0.0279200| -1.8813806| -0.9853768|\n|Qatar                |QAT  | 0.0644169| 0.0009699| -0.0634469| -0.9849429|\n|Singapore            |SGP  | 0.4978197| 0.0092563| -0.4885635| -0.9814064|\n|South Korea          |KOR  | 0.2447635| 0.0046286| -0.2401350| -0.9810896|\n|Turkey               |TUR  | 2.5690001| 0.0508833| -2.5181169| -0.9801934|\n|Kuwait               |KWT  | 0.2114786| 0.0055718| -0.2059068| -0.9736530|\n|Palestine            |PSE  | 6.7359912| 0.1792879| -6.5567033| -0.9733836|\n|Bahrain              |BHR  | 1.4361586| 0.0394449| -1.3967137| -0.9725345|\n|Brunei               |BRN  | 1.1089297| 0.0379083| -1.0710214| -0.9658154|\n:::\n:::\n\n\n\nInteractive chart\n\n\n::: {.cell}\n\n:::\n\n\n### Chloropleth\n\n1. Prepare country codes\n2. Draw base map\n3. Connect\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tmap)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'tmap' was built under R version 4.1.2\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: multiple methods tables found for 'direction'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: multiple methods tables found for 'gridDistance'\n```\n:::\n\n```{.r .cell-code}\nlibrary(sf)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'sf' was built under R version 4.1.2\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLinking to GEOS 3.9.1, GDAL 3.2.1, PROJ 7.2.1; sf_use_s2() is TRUE\n```\n:::\n\n```{.r .cell-code}\ndata(\"World\")\n\nworld <- World %>% as_tibble()\n\ndf_map <- df %>% \n    filter(year == 2019) %>% \n    distinct() %>% \n    left_join(world, by = c(\"code\" = \"iso_a3\"))\n\ndf_map %>%\n  st_as_sf() %>%\n  ggplot() +\n  geom_sf(data = World, fill = \"grey80\", alpha = .5) +\n  geom_sf(aes(fill = death_rate)) +\n  scale_fill_viridis_c(trans = \"sqrt\") +\n  labs(fill = \"Death rate from indoor air pollution\") +\n  guides(fill = guide_colorbar(\n    barwidth = 25, barheight = 1,\n    title.position = \"top\",\n    title.hjust = .5\n  )) +\n  theme(legend.position = \"bottom\")\n```\n\n::: {.cell-output-display}\n![](Indoor_air_pollution_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n### Interactive map that allows you to click through\n\n",
    "supporting": [
      "Indoor_air_pollution_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}